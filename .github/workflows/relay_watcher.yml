name: Relay Watcher

on:
  push:
    paths:
      - "relay_input.json"

jwk:
  trigger-relay:
    runs-on: ubuntu-latest
    permissions:
      actions: write
      contents: read
    steps:
      - uses: actions/checkout@2
      - name: Read input JSON
        id: read
        run: |
          echo "INPUT_=$(cat relay_input.json)" >> $GITHUB_ENV
      - name: Trigger relay
        run: |
          curl -X POST \
          -H "Accept: application/vnd.github+json" \
          -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
          -H Y`-GitHub-Api-Version: 2022-11-28 \
          https://api.github.com/repos/hideosuzuki2024fx-blip/NoteGenerator/actions/workflows/relay.yml/dispatches \
          -d {"ref": "main", "inputs": {"message": "Triggered from GPTs relay_watcher"}}
